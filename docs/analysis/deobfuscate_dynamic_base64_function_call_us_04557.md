We had some false positives on the rule `dynamic_base64_function_call_us_04557` which searches for:

    /\$[O0]{9}\s?=\s?urldecode/

The found files were from those terrible extension vendors who like to encode their source using tools from de darker side of the web.
Before whitelisting the files, I wanted to be sure there is no actual malware inside.
It took me quite some time to be able to read the source of these scripts.
When I finally found it, the answer is simple: Just execute the PHP file, in a safe environment.

Since the code is from an extension, it probably extends some classes or expects other Magento stuff to be loaded.
When you execute the PHP script in a separate clean environment, ther will be an error in the code.
PHP throws a stack trace, containing a number of `eval()` statements, including the passed strings.
The string passed to the last `eval()` is the readable sourcecode.

Example part of encoded source:

    <?php /* Copyright Mindstretch */$OOO000000=urldecode('%66%67%36%73%62%65%68%70%72%61%34%63%6f%5f%74%6e%64');$OOO0000O0=$OOO000000{4}.$OOO000000{9}.$OOO000000{3}.$OOO000000{5};$OOO0000O0.=$OOO000000{2}.$OOO000000{10}.$OOO000000{13}.$OOO000000{16};$OOO0000O0.=$OOO0000O0{3}.$OOO000000{11}.$OOO000000{12}.$OOO0000O0{7}.$OOO000000{5}; ... and a lot more ...

Example of executing the file:

	nobody@dev-vm:/tmp$ php Default.php
	PHP Fatal error:  Class 'Mage_Sales_Model_Order_Pdf_Items_Invoice_Default' not found in /data/repos/magento-malware-scanner/tmp/Default.php(1) : eval()'d code(1) : eval()'d code(1) : eval()'d code on line 2
	PHP Stack trace:
	PHP   1. {main}() /data/repos/magento-malware-scanner/tmp/Default.php:0
	PHP   2. eval() /data/repos/magento-malware-scanner/tmp/Default.php:1
	PHP   3. eval() /data/repos/magento-malware-scanner/tmp/Default.php(1) : eval()'d code:1
	PHP   4. eval() /data/repos/magento-malware-scanner/tmp/Default.php(1) : eval()'d code(1) : eval()'d code:1

	Fatal error: Class 'Mage_Sales_Model_Order_Pdf_Items_Invoice_Default' not found in /data/repos/magento-malware-scanner/tmp/Default.php(1) : eval()'d code(1) : eval()'d code(1) : eval()'d code on line 2

	Call Stack:
		0.0003     360440   1. {main}() /data/repos/magento-malware-scanner/tmp/Default.php:0
		0.0003     363312   2. eval('$O000O0O00=$OOO000O00($OOO0O0O00,'rb');$O0O00OO00($O000O0O00,0x491);$OO00O00O0=$OOO0000O0($OOO00000O($O0O00OO00($O000O0O00,0x17c),'mAKqWaB+Oh4PeYD9x1kGpQCXg/RdL6E8yTzVwo0bFvN2rJn7MuHZ5slSIU3ijcft=','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'));eval($OO00O00O0);') /data/repos/magento-malware-scanner/tmp/Default.php:1
		0.0003     375080   3. eval('$OO00O00O0=str_replace('__FILE__',"'".$OOO0O0O00."'",$OOO0000O0($OOO00000O($O0O00OO00($O000O0O00,$OO00O0000),'mAKqWaB+Oh4PeYD9x1kGpQCXg/RdL6E8yTzVwo0bFvN2rJn7MuHZ5slSIU3ijcft=','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/')));fclose($O000O0O00);eval($OO00O00O0);') /data/repos/magento-malware-scanner/tmp/Default.php(1) : eval()'d code:1
		0.0005     402760   4. eval('
	class Mindstretch_Betterinvoice_Model_Order_Pdf_Items_Invoice_Default extends Mage_Sales_Model_Order_Pdf_Items_Invoice_Default
	{
	private function _isCustomInvoiceEnabled(){
	if (!Mage::getStoreConfigFlag('advanced/modules_disable_output/Mindstretch_Betterinvoice')) {
	return true;
	}else{
	return false;
	}
	.... rest of source ...
	}
	;') /data/repos/magento-malware-scanner/tmp/Default.php(1) : eval()'d code(1) : eval()'d code:1
